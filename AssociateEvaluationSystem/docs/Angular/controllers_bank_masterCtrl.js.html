<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controllers/bank/masterCtrl.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controllers/bank/masterCtrl.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @class AES.bankApp.MasterCtrl
 */

app.controller('MasterCtrl', [
		'$scope',
		'$rootScope',
		'$log',
		'$state',
		'$http',
		'Upload',
		'questionBuilderService',
		function($scope, $rootScope, $log, $state, $http, Upload,
				questionBuilderService) {

			$scope.templateName = "";
			$scope.snippetError = false;
			$scope.submittingSnippet = false;
			$scope.snippetFileSuccess = false;
			$scope.snippetTextSuccess = false;
			$scope.busy = true;
			$scope.ready = false;
			$scope.files = [];

			$scope.addCategories = function() {
				$state.go("category")
				$scope.templateName = "Add Categories";
			};

			$scope.addTags = function() {
				$state.go("tag");
				$scope.templateName = "Add Tags";
			};

			$scope.modifyQuestions = function() {
				$state.go("question");
				$scope.templateName = "Modify Questions";
			};

			$scope.uploadAssessment = function() {
				$state.go("upload");
				$scope.templateName = "Upload Assessment";
			};
			$scope.addQuestion = function() {
				$state.go("fullQuestion");
				$scope.templateName = "Add Question";
			};

			$scope.uploadFile = function() {
				// Start the progressbar
				$scope.progressbar.start;
				// File uploaded by the user
				var file = $scope.myFile;
				// URL to Spring Controller
				var uploadUrl = "/aes/parseAiken";
				fileUpload.uploadFileToUrl(file, uploadUrl).then(
						$scope.completeProgressbar);
			};

			$scope.$watch('files', function() {
				angular.forEach($scope.files, function(file) {
					var fileArr = [ file ];
					$scope.upload(fileArr, file.type);
				})

			});

			$scope.submitSnippetFiles = function(isValid) {
				if (!isValid) {
					alert('Problem with form, aborting.');
					return;
				}

				$scope.submittingSnippet = true;

				// Upload the files to the S3 container
				$scope.files.push($scope.snippetTemplateFile);
				$scope.files.push($scope.snippetSolutionFile);
				var folderNames = [ 'SnippetTemplates', 'SnippetSolutions' ]
				$scope.upload($scope.files, [ 'SnippetTemplates',
						'SnippetSolutions' ]);

				// Upload question complete with URLs to the database
				var questionText = $scope.questionText;
				var snippetTemplateUrl = folderNames[0] + '/'
						+ $scope.snippetTemplateFile.name;
				var snippetSolutionUrl = folderNames[1] + '/'
						+ $scope.snippetSolutionFile.name;
				var fileType = $scope.fileType;
				var builder = new questionBuilderService.questionBuilder();
				builder.createSnippetQuestionBuilder(questionText, fileType,
						snippetTemplateUrl, snippetSolutionUrl);
				builder.addQuestionCategory(1, $scope.textSnippetFileType);
				question = builder.build();

				questionJSON = JSON.stringify(question);
				$http({
					method : "POST",
					url : "question",
					data : questionJSON
				}).then(function(response) { // success
					$scope.submittingSnippet = false;
					$scope.snippetFileSuccess = true;
				}, function(reason) { // error
					$scope.snippetError = true;
				});

			}

			$scope.submitSnippetText = function(isValid) {
				if (!isValid) {
					alert('Problem with form, aborting.');
					return;
				}

				$scope.submittingSnippet = true;

				var folderNames = [ 'SnippetTemplates', 'SnippetSolutions' ]
				var snippetTemplateUrl = folderNames[0] + '/'
						+ $scope.textSnippetFileName + 'Template.'
						+ $scope.textSnippetFileType;
				var snippetSolutionUrl = folderNames[1] + '/'
						+ $scope.textSnippetFileName + 'Solution.'
						+ $scope.textSnippetFileType;

				var builder = new questionBuilderService.questionBuilder();
				builder.createSnippetQuestionBuilder(
						$scope.textSnippetQuestionText,
						$scope.textSnippetFileType, snippetTemplateUrl,
						snippetSolutionUrl);
				builder.addQuestionCategory(1, $scope.textSnippetFileType);
				question = builder.build();

				// Upload template to the S3 container

				$http(
						{
							method : "POST",
							url : "rest/s3uploadTextAsFile/"
									+ question.snippetTemplates[0].templateUrl,
							data : $scope.textSnippetTemplate
						}).then(function(response) { // success
				}, function(reason) { // error
					$scope.snippetError = true;
				});

				// Upload solution to the S3 container
				$http(
						{
							method : "POST",
							url : "rest/s3uploadTextAsFile/"
									+ question.snippetTemplates[0].solutionUrl,
							data : $scope.textSnippetSolution
						}).then(function(response) { // success
				}, function(reason) { // error
					$scope.snippetError = true;
				});

				// Update database with question, complete with URLs
				questionJSON = JSON.stringify(question);
				$http({
					method : "POST",
					url : "question",
					data : questionJSON
				}).then(function(response) { // success
					$scope.submittingSnippet = false;
					$scope.snippetTextSuccess = !$scope.snippetError;
				}, function(reason) { // error
					$scope.snippetError = true;
				});

			}

			$scope.progressUpdater = function(evt) {
				return parseInt(100.0 * evt.loaded / evt.total);
			};

			$scope.someFunction = function(data, status, headers, config) {
				// keeping it to shut up sonarQube. This is that hot fix doe.
			};
			
			
			
			$scope.upload = function(files, folderNames) {
				
				var funcEVT = function(evt){
					parseInt(100.0 * evt.loaded / evt.total);
				}
				var funcDSHC = function(data, status, headers, config){			
					
				}	
			
				if (files &amp;&amp; files.length) {
					for (var i = 0; i &lt; files.length; i++) {
						var file = files[i];
						Upload.upload({
							url : 'rest/s3uploadFile/' + folderNames[i],
							method : 'POST',
							file : file
						}).progress(funcEVT) 
						.success(funcDSHC);
					}
				}
			};
		} ]);</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AES.adminApp.AdminDashboardCtrl.html">AdminDashboardCtrl</a></li><li><a href="AES.adminApp.ChooseAssessmentCtrl.html">ChooseAssessmentCtrl</a></li><li><a href="AES.adminApp.CreateAssessmentCtrl.html">CreateAssessmentCtrl</a></li><li><a href="AES.adminApp.EmployeeViewCtrl.html">EmployeeViewCtrl</a></li><li><a href="AES.adminApp.MenuCtrl.html">MenuCtrl</a></li><li><a href="AES.adminApp.parserCtrl.html">parserCtrl</a></li><li><a href="AES.adminApp.RegisterEmployeeCtrl.html">RegisterEmployeeCtrl</a></li><li><a href="AES.adminApp.SettingsViewCtrl.html">SettingsViewCtrl</a></li><li><a href="AES.adminApp.UpdateEmployeeCtrl.html">UpdateEmployeeCtrl</a></li><li><a href="AES.asmtApp.CountdownController.html">CountdownController</a></li><li><a href="AES.asmtApp.landingPageCtrl.html">landingPageCtrl</a></li><li><a href="AES.asmtApp.quizController.html">quizController</a></li><li><a href="AES.asmtApp.QuizNavController.html">QuizNavController</a></li><li><a href="AES.asmtApp.quizReviewController.html">quizReviewController</a></li><li><a href="AES.bankApp.CategoryCtrl.html">CategoryCtrl</a></li><li><a href="AES.bankApp.MasterCtrl.html">MasterCtrl</a></li><li><a href="AES.bankApp.MenuCtrl.html">MenuCtrl</a></li><li><a href="AES.bankApp.QuestionCtrl.html">QuestionCtrl</a></li><li><a href="AES.bankApp.TagCtrl.html">TagCtrl</a></li><li><a href="AES.userApp.CandidateCtrl.html">CandidateCtrl</a></li><li><a href="AES.userApp.LoginCtrl.html">LoginCtrl</a></li><li><a href="AES.userApp.menuCtrl.html">menuCtrl</a></li><li><a href="AES.userApp.recruiterDashboardCtrl.html">recruiterDashboardCtrl</a></li><li><a href="AES.userApp.UpdateEmployeeCtrl.html">UpdateEmployeeCtrl</a></li></ul><h3>Namespaces</h3><ul><li><a href="AES.adminApp.html">adminApp</a></li><li><a href="AES.asmtApp.html">asmtApp</a></li><li><a href="AES.bankApp.html">bankApp</a></li><li><a href="AES.userApp.html">userApp</a></li><li><a href="AES%250DCreated%2520by%2520Mehrab%2520on%25205_30_2017..html">AESCreated by Mehrab on 5/30/2017.</a></li><li><a href="attr.ngfAsBackground.html">ngfAsBackground</a></li><li><a href="attr.ngfBackground.html">ngfBackground</a></li><li><a href="attr.ngfCapture.html">ngfCapture</a></li><li><a href="attr.ngfChange.html">ngfChange</a></li><li><a href="attr.ngfKeep.html">ngfKeep</a></li><li><a href="attr.ngfModelOptions.html">ngfModelOptions</a></li><li><a href="attr.ngfMultiple.html">ngfMultiple</a></li><li><a href="attr.ngfNoObjectUrl.html">ngfNoObjectUrl</a></li><li><a href="attr.ngfSelect.html">ngfSelect</a></li><li><a href="attr.ngfSize.html">ngfSize</a></li><li><a href="attr.ngfSrc.html">ngfSrc</a></li><li><a href="attr.ngfThumbnail.html">ngfThumbnail</a></li><li><a href="attr.ngfValidate.html">ngfValidate</a></li><li><a href="attr.ngModel.html">ngModel</a></li></ul><h3>Global</h3><ul><li><a href="global.html#$get">$get</a></li><li><a href="global.html#adjustTop">adjustTop</a></li><li><a href="global.html#calculatePosition">calculatePosition</a></li><li><a href="global.html#dragItem">dragItem</a></li><li><a href="global.html#eventObj">eventObj</a></li><li><a href="global.html#getRawNode">getRawNode</a></li><li><a href="global.html#height">height</a></li><li><a href="global.html#isScrollable">isScrollable</a></li><li><a href="global.html#isTouchInvalid">isTouchInvalid</a></li><li><a href="global.html#movePosition">movePosition</a></li><li><a href="global.html#noDrag">noDrag</a></li><li><a href="global.html#offset">offset</a></li><li><a href="global.html#offsetParent">offsetParent</a></li><li><a href="global.html#options">options</a></li><li><a href="global.html#parsePlacement">parsePlacement</a></li><li><a href="global.html#parseStyle">parseStyle</a></li><li><a href="global.html#position">position</a></li><li><a href="global.html#positionArrow">positionArrow</a></li><li><a href="global.html#positionElements">positionElements</a></li><li><a href="global.html#positionStarted">positionStarted</a></li><li><a href="global.html#scrollbarPadding">scrollbarPadding</a></li><li><a href="global.html#scrollbarWidth">scrollbarWidth</a></li><li><a href="global.html#scrollParent">scrollParent</a></li><li><a href="global.html#setTriggers">setTriggers</a></li><li><a href="global.html#viewportOffset">viewportOffset</a></li><li><a href="global.html#width">width</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue May 30 2017 10:36:13 GMT-0400 (DST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
